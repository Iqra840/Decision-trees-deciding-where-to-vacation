#!/usr/bin/env python
# coding: utf-8

# In[1]:


get_ipython().run_line_magic('matplotlib', 'inline')
from matplotlib import pyplot as plt
plt.rcParams['figure.figsize'] = (7,10)

import numpy as np
import pandas as pd
from sklearn import tree
from sklearn.preprocessing import LabelEncoder
import collections
from sklearn.model_selection import GridSearchCV, cross_val_score
from sklearn.tree import DecisionTreeClassifier, plot_tree
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score
import graphviz
 


# In[2]:


#Creating the dataset
def create_df(dic, feature_list):
    out = pd.DataFrame(dic)
    out = pd.concat([out, pd.get_dummies(out[feature_list])], axis = 1)
    out.drop(feature_list, axis = 1, inplace = True)
    return out

# Some feature values are present in train and absent in test and vice-versa.
def intersect_features(train, test):
    common_feat = list( set(train.keys()) & set(test.keys()))
    return train[common_feat], test[common_feat]
features = ['Rain', 'Snow','Wind','Heat']

#Training Data
df_train = {}
df_train['Rain'] = ['rainy', 'rainy', 'rainy', 'dry',
                         'dry', 'dry', 'rainy'] 
df_train['Snow'] = ['yes', 'yes', 'no', 'no', 'yes', 'yes', 'yes']
df_train['Wind'] = ['high', 'low', 'average', 'average', 'low',
                                   'high', 'average']
df_train['Heat'] = ['lots', 'little', 'lots', 'little', 'lots',
                                  'lots', 'lots']
df_train['Should_Vacation_there'] = LabelEncoder().fit_transform(['+', '-', '+', '-', '-', '+', '+'])

df_train = create_df(df_train, features)
df_train


# In[3]:


#Test data
df_test = {}
df_test['Rain'] = ['rainy', 'rainy', 'dry'] 
df_test['Snow'] = ['no', 'yes', 'yes']
df_test['Wind'] = ['average', 'high', 'average']
df_test['Heat'] = ['lots', 'little', 'lots']
df_test = create_df(df_test, features)
df_test


# In[4]:


# Some feature values are present in train and absent in test and vice-versa.
y = df_train['Should_Vacation_there']
df_train, df_test = intersect_features(train=df_train, test=df_test)
df_train

#training a decision tree
dt = DecisionTreeClassifier(criterion='entropy', random_state=17)
dt.fit(df_train, y);

#displaying the tree
plot_tree(dt, feature_names=df_train.columns, filled=True,
        class_names=["Should go there", "Shouldn't go there"]);


# In[ ]:





# In[ ]:




